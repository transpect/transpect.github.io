<?xml version="1.0" encoding="UTF-8"?><html xmlns="http://www.w3.org/1999/xhtml" xml:base="../modules-epubtools.html">
  <head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>epubtools</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    
    <meta name="theme-color" content="#FF9800" />
    
    <link rel="apple-touch-icon-precomposed" href="icons/apple-touch-icon-152x152.png" />
    <meta name="msapplication-TileImage" content="icons/mstile-144x144.png" />
    <link rel="icon" href="icons/favicon-32x32.png" sizes="32x32" />
    
    <link type="text/css" rel="stylesheet" media="screen,projection" href="css/prism.css" />
    <link type="text/css" rel="stylesheet" media="screen,projection" href="css/materialize.min.css" />
    <link type="text/css" rel="stylesheet" media="screen,projection" href="css/le-tex.css" />
  </head>
  <body id="modules-epubtools">
    
    <header>
      <div class="container"><a href="#" data-activates="tr-nav" class="button-collapse top-nav circle hide-on-large-only"><i class="mdi-navigation-menu"></i></a></div>
      
      
      <ul id="tr-nav" class="side-nav fixed" style="width:260px">
        <li class="logo"><a id="logo-container" href="#" class="brand-logo"><object id="front-page-logo" type="image/svg+xml" data="icons/logo-transpect.svg">Your browser does not support SVG</object></a></li>
        
      <li class="naventry-1st"><a href="index.html">About</a></li><li class="naventry-1st"><a href="getting-started.html">Getting Started</a></li><li class="active no-padding"><ul class="collapsible collapsible-accordion"><li class="active naventry-1st" id="d33714e415"><a class="active collapsible-header">Modules</a><div style="display:block" class="collapsible-body"><ul><li class="naventry-2nd"><a href="modules-basex-svn-api.html">basex-svn-api</a></li><li class="naventry-2nd"><a href="modules-bits2hub.html">bits2hub</a></li><li class="naventry-2nd"><a href="modules-calabash-distro.html">calabash-distro</a></li><li class="naventry-2nd"><a href="modules-calabash-frontend.html">calabash-frontend</a></li><li class="naventry-2nd"><a href="modules-cascade.html">cascade</a></li><li class="naventry-2nd"><a href="modules-control.html">control</a></li><li class="naventry-2nd"><a href="modules-control-backend.html">control-backend</a></li><li class="naventry-2nd"><a href="modules-crossref.html">crossref</a></li><li class="naventry-2nd"><a href="modules-css-tools.html">css-tools</a></li><li class="naventry-2nd"><a href="modules-docx2hub.html">docx2hub</a></li><li class="naventry-2nd"><a href="modules-docx2hub-frontend.html">docx2hub-frontend</a></li><li class="naventry-2nd"><a href="modules-docx2jats-demo.html">docx2jats-demo</a></li><li class="naventry-2nd"><a href="modules-docx2tex.html">docx2tex</a></li><li class="naventry-2nd"><a href="modules-docx_modify-lib.html">docx_modify-lib</a></li><li class="naventry-2nd"><a href="modules-epub-font-subsetter.html">epub-font-subsetter</a></li><li class="naventry-2nd"><a href="modules-epub2hub-lib.html">epub2hub-lib</a></li><li class="naventry-2nd"><a href="modules-epubcheck-extension.html">epubcheck-extension</a></li><li class="naventry-2nd"><a href="modules-epubcheck-idpf.html">epubcheck-idpf</a></li><li class="naventry-2nd"><a href="modules-epubcheck-transpect.html">epubcheck-transpect</a></li><li class="active naventry-2nd"><a href="modules-epubtools.html">epubtools</a></li><li class="naventry-2nd"><a href="modules-epubtools-frontend.html">epubtools-frontend</a></li><li class="naventry-2nd"><a href="modules-evolve-hub.html">evolve-hub</a></li><li class="naventry-2nd"><a href="modules-font-obfuscate-extension.html">font-obfuscate-extension</a></li><li class="naventry-2nd"><a href="modules-fontmaps.html">fontmaps</a></li><li class="naventry-2nd"><a href="modules-github-api.html">github-api</a></li><li class="naventry-2nd"><a href="modules-html2hub.html">html2hub</a></li><li class="naventry-2nd"><a href="modules-html2xlsx.html">html2xlsx</a></li><li class="naventry-2nd"><a href="modules-htmlreports.html">htmlreports</a></li><li class="naventry-2nd"><a href="modules-htmltables.html">htmltables</a></li><li class="naventry-2nd"><a href="modules-htmltemplates.html">htmltemplates</a></li><li class="naventry-2nd"><a href="modules-hub2bits.html">hub2bits</a></li><li class="naventry-2nd"><a href="modules-hub2dbk.html">hub2dbk</a></li><li class="naventry-2nd"><a href="modules-hub2docx-frontend.html">hub2docx-frontend</a></li><li class="naventry-2nd"><a href="modules-hub2docx-lib.html">hub2docx-lib</a></li><li class="naventry-2nd"><a href="modules-hub2html.html">hub2html</a></li><li class="naventry-2nd"><a href="modules-hub2tei.html">hub2tei</a></li><li class="naventry-2nd"><a href="modules-idml2xml.html">idml2xml</a></li><li class="naventry-2nd"><a href="modules-idml2xml-frontend.html">idml2xml-frontend</a></li><li class="naventry-2nd"><a href="modules-idml_docx-to-docbook_epub-demo.html">idml_docx-to-docbook_epub-demo</a></li><li class="naventry-2nd"><a href="modules-idmlvalidation.html">idmlvalidation</a></li><li class="naventry-2nd"><a href="modules-image-props-extension.html">image-props-extension</a></li><li class="naventry-2nd"><a href="modules-image-transform-extension.html">image-transform-extension</a></li><li class="naventry-2nd"><a href="modules-jats2html.html">jats2html</a></li><li class="naventry-2nd"><a href="modules-javascript-extension.html">javascript-extension</a></li><li class="naventry-2nd"><a href="modules-jing-trang-patch.html">jing-trang-patch</a></li><li class="naventry-2nd"><a href="modules-kindlegen-amzn.html">kindlegen-amzn</a></li><li class="naventry-2nd"><a href="modules-latex-math-images.html">latex-math-images</a></li><li class="naventry-2nd"><a href="modules-logo.html">logo</a></li><li class="naventry-2nd"><a href="modules-map-style-names.html">map-style-names</a></li><li class="naventry-2nd"><a href="modules-markdown2hub.html">markdown2hub</a></li><li class="naventry-2nd"><a href="modules-mathtype-extension.html">mathtype-extension</a></li><li class="naventry-2nd"><a href="modules-mml-normalize.html">mml-normalize</a></li><li class="naventry-2nd"><a href="modules-mml2tex.html">mml2tex</a></li><li class="naventry-2nd"><a href="modules-nlm-stylechecker.html">nlm-stylechecker</a></li><li class="naventry-2nd"><a href="modules-officeopenxml-validation.html">officeopenxml-validation</a></li><li class="naventry-2nd"><a href="modules-pdf2fxl.html">pdf2fxl</a></li><li class="naventry-2nd"><a href="modules-pygmentize-xpl.html">pygmentize-xpl</a></li><li class="naventry-2nd"><a href="modules-rng-extension.html">rng-extension</a></li><li class="naventry-2nd"><a href="modules-schema-bits.html">schema-bits</a></li><li class="naventry-2nd"><a href="modules-schema-html.html">schema-html</a></li><li class="naventry-2nd"><a href="modules-schema-jats.html">schema-jats</a></li><li class="naventry-2nd"><a href="modules-schema-onix.html">schema-onix</a></li><li class="naventry-2nd"><a href="modules-schematron.html">schematron</a></li><li class="naventry-2nd"><a href="modules-semex.html">semex</a></li><li class="naventry-2nd"><a href="modules-stylemapper-frontend.html">stylemapper-frontend</a></li><li class="naventry-2nd"><a href="modules-stylemapper-lib.html">stylemapper-lib</a></li><li class="naventry-2nd"><a href="modules-svn-extension.html">svn-extension</a></li><li class="naventry-2nd"><a href="modules-tei2bits.html">tei2bits</a></li><li class="naventry-2nd"><a href="modules-tei2html.html">tei2html</a></li><li class="naventry-2nd"><a href="modules-tei2hub.html">tei2hub</a></li><li class="naventry-2nd"><a href="modules-tokenized-to-tree.html">tokenized-to-tree</a></li><li class="naventry-2nd"><a href="modules-transpect-tex.html">transpect-tex</a></li><li class="naventry-2nd"><a href="modules-transpect.github.io.html">transpect.github.io</a></li><li class="naventry-2nd"><a href="modules-transpectdoc.html">transpectdoc</a></li><li class="naventry-2nd"><a href="modules-unwrap-mml.html">unwrap-mml</a></li><li class="naventry-2nd"><a href="modules-unzip-extension.html">unzip-extension</a></li><li class="naventry-2nd"><a href="modules-upload-webcomponent.html">upload-webcomponent</a></li><li class="naventry-2nd"><a href="modules-use-css-decorator-classes.html">use-css-decorator-classes</a></li><li class="naventry-2nd"><a href="modules-xerif.html">xerif</a></li><li class="naventry-2nd"><a href="modules-xerif-demo.html">xerif-demo</a></li><li class="naventry-2nd"><a href="modules-xlsx2html-frontend.html">xlsx2html-frontend</a></li><li class="naventry-2nd"><a href="modules-xlsx2html-lib.html">xlsx2html-lib</a></li><li class="naventry-2nd"><a href="modules-xml2idml.html">xml2idml</a></li><li class="naventry-2nd"><a href="modules-xml2tex.html">xml2tex</a></li><li class="naventry-2nd"><a href="modules-xproc-util.html">xproc-util</a></li><li class="naventry-2nd"><a href="modules-xslt-util.html">xslt-util</a></li></ul></div></li></ul></li><li class="naventry-1st"><a href="styleguide.html">Styleguide</a></li><li class="naventry-1st"><a href="tutorial.html">Tutorials</a></li></ul>
    </header>
    
    <main>
      <div class="section orange" id="index-banner">
        <div class="container">
          <h1 id="tr-title" class="light header center-on-small-only white-text">epubtools</h1>
          <h4 id="tr-subtitle" class="light orange-text text-lighten-4 center-on-small-only">Library to convert and check EPUB 2 and 3</h4>
        </div>
      </div>
      <div class="container">
        <div class="row">
          
          <div class="col s12 m9 l10" id="tr-content"><div class="card"><div class="card-content"><span class="card-title">Repository</span><table class="informaltable"><tbody><tr><td>Git URL</td><td><code class="language-markup">https://github.com/transpect/epubtools.git</code></td></tr><tr><td>SVN URL</td><td><code class="language-markup">https://github.com/transpect/epubtools</code></td></tr><tr><td>Base URI</td><td><code class="language-markup">http://transpect.io/epubtools/</code></td></tr></tbody></table><p><a href="https://github.com/transpect/epubtools" class="btn-flat  orange lighten-4">Source ⬇</a></p></div></div><div id="epub-create-ocf" class="section scrollspy"><h2 class="header">epub:create-ocf</h2><p> This step is used to create the directory structure of the OCF Abstract Container. It is required to provide
    as option the path to the source html file. </p><h4>Import</h4><pre><code class="language-markup">&lt;p:import href="http://transpect.io/epubtools/modules/create-ocf/xpl/create-ocf.xpl"/&gt;</code></pre><h4>Synopsis</h4><pre><code class="language-markup">&lt;epub:create-ocf xmlns:epub="http://transpect.io/epubtools"&gt;
  &lt;p:input port="meta"/&gt;
  &lt;p:output port="result" sequence="true" primary="true"/&gt;
  &lt;p:output port="files" primary="false"/&gt;
  &lt;p:option name="base-uri" required="true"/&gt;
  &lt;p:option name="debug" select="'no'"/&gt;
  &lt;p:option name="debug-dir-uri" select="'debug'"/&gt;
&lt;/epub:create-ocf&gt;</code></pre></div><div id="epub-create-opf" class="section scrollspy"><h2 class="header">epub:create-opf</h2><p> This step expects a file list of the EPUB content files in this form:
            &lt;cx:document&gt;
                &lt;c:file name="OEBPS/chapter01.xhtml"/&gt;
            &lt;/cx:document&gt;
    It provides the OPF file on the result port. The output of the files port is the file reference of the content.opf but not
    all file references in the OPF file. </p><h4>Import</h4><pre><code class="language-markup">&lt;p:import href="http://transpect.io/epubtools/modules/create-opf/xpl/create-opf.xpl"/&gt;</code></pre><h4>Dependencies</h4><ul><li><p><a href="modules-xproc-util.html">xproc-util</a></p></li><li><p><a href="modules-xslt-util.html">xslt-util</a></p></li></ul><h4>Synopsis</h4><pre><code class="language-markup">&lt;epub:create-opf xmlns:epub="http://transpect.io/epubtools"&gt;
  &lt;p:input port="source"/&gt;
  &lt;p:input port="meta"/&gt;
  &lt;p:output port="result" primary="true"/&gt;
  &lt;p:output port="files" primary="false"/&gt;
  &lt;p:option name="base-uri" required="true"/&gt;
  &lt;p:option name="target" select="'EPUB2'"/&gt;
  &lt;p:option name="terminate-on-error" select="'yes'"/&gt;
  &lt;p:option name="use-svg" select="'yes'"/&gt;
  &lt;p:option name="debug" select="'no'"/&gt;
  &lt;p:option name="debug-dir-uri" select="'debug'"/&gt;
&lt;/epub:create-opf&gt;</code></pre></div><div id="epub-create-ops" class="section scrollspy"><h2 class="header">epub:create-ops</h2><p>Hashed file names are patched into the HTML before split</p><h4>Import</h4><pre><code class="language-markup">&lt;p:import href="http://transpect.io/epubtools/modules/create-ops/xpl/create-ops.xpl"/&gt;</code></pre><h4>Dependencies</h4><ul><li><p><a href="modules-image-props-extension.html">image-props-extension</a></p></li><li><p><a href="modules-xproc-util.html">xproc-util</a></p></li><li><p><a href="modules-css-tools.html">css-tools</a></p></li><li><p><a href="modules-xslt-util.html">xslt-util</a></p></li></ul><h4>Synopsis</h4><pre><code class="language-markup">&lt;epub:create-ops xmlns:epub="http://transpect.io/epubtools"&gt;
  &lt;p:input port="source" primary="true"/&gt;
  &lt;p:input port="conf" sequence="true" primary="false"/&gt;
  &lt;p:input port="meta" primary="false"/&gt;
  &lt;p:input port="attach-cover-xsl" primary="false"/&gt;
  &lt;p:input port="create-svg-cover-xsl" primary="false"/&gt;
  &lt;p:input port="cover-svg" primary="false"/&gt;
  &lt;p:output port="result" primary="true"/&gt;
  &lt;p:output port="html"/&gt;
  &lt;p:output port="files" primary="false"/&gt;
  &lt;p:output port="report" sequence="true" primary="false"/&gt;
  &lt;p:output port="splitting-report" sequence="true"/&gt;
  &lt;p:option name="base-uri" required="true"/&gt;
  &lt;p:option name="target" select="'EPUB2'"/&gt;
  &lt;p:option name="css-filename" required="false" select="'stylesheet.css'"/&gt;
  &lt;p:option name="use-svg" select="'yes'"/&gt;
  &lt;p:option name="terminate-on-error" required="false" select="'yes'"/&gt;
  &lt;p:option name="debug" required="false" select="'no'"/&gt;
  &lt;p:option name="debug-dir-uri" required="false" select="'debug'"/&gt;
  &lt;p:option name="status-dir-uri" select="'status'"/&gt;
  &lt;p:option name="create-font-subset" required="false" select="'false'"/&gt;
  &lt;p:option name="font-subset-min-file-size" required="false" select="0"/&gt;
  &lt;p:option name="create-svg-cover" required="false" select="'false'"/&gt;
  &lt;p:option name="convert-svg-cover" required="false" select="'false'"/&gt;
&lt;/epub:create-ops&gt;</code></pre></div><div id="tr-create-font-subset" class="section scrollspy"><h2 class="header">tr:create-font-subset</h2><p>This pipeline creates fontsubsets. The characters used 
    in each font will be displayed in a character set. The subset is created 
    using the pyftsubset phython script from fonttools https://github.com/fonttools.
  </p><h4>Import</h4><pre><code class="language-markup">&lt;p:import href="http://transpect.io/epubtools/modules/fontsubsetter/xpl/fontsubsetter.xpl"/&gt;</code></pre><h4>Dependencies</h4><ul><li><p><a href="modules-css-tools.html">css-tools</a></p></li><li><p><a href="modules-xproc-util.html">xproc-util</a></p></li></ul><h4>Synopsis</h4><pre><code class="language-markup">&lt;tr:create-font-subset xmlns:tr="http://transpect.io"&gt;
  &lt;p:input port="source" primary="true"/&gt;
  &lt;p:input port="expand-css"/&gt;
  &lt;p:output port="result" sequence="true" primary="true"/&gt;
  &lt;p:option name="script-path" select="'../../../scripts/pyftsubset.sh'"/&gt;
  &lt;p:option name="min-file-size-kb" select="0"/&gt;
  &lt;p:option name="debug" required="false" select="'yes'"/&gt;
  &lt;p:option name="debug-dir-uri" select="'debug'"/&gt;
&lt;/tr:create-font-subset&gt;</code></pre></div><div id="epub-html-splitter" class="section scrollspy"><h2 class="header">epub:html-splitter</h2><p>
    <p xmlns:p="http://www.w3.org/ns/xproc" xmlns:epub="http://transpect.io/epubtools" xmlns:tr="http://transpect.io" xmlns:css="http://www.w3.org/1996/css" xmlns:html="http://www.w3.org/1999/xhtml" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:c="http://www.w3.org/ns/xproc-step" xmlns:j="http://marklogic.com/json" xmlns:cx="http://xmlcalabash.com/ns/extensions" xmlns:xlink="http://www.w3.org/1999/xlink">Sample invocation (for debugging purposes):</p>
    <pre xmlns:p="http://www.w3.org/ns/xproc" xmlns:epub="http://transpect.io/epubtools" xmlns:tr="http://transpect.io" xmlns:css="http://www.w3.org/1996/css" xmlns:html="http://www.w3.org/1999/xhtml" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:c="http://www.w3.org/ns/xproc-step" xmlns:j="http://marklogic.com/json" xmlns:cx="http://xmlcalabash.com/ns/extensions" xmlns:xlink="http://www.w3.org/1999/xlink">calabash/calabash.sh 
    -i source=file:/$(cygpath -ma ../content/output/debug/epubtools/create-ops/pre-split.html) 
    -i meta=file:/$(cygpath -ma a9s/publisher/series/epubtools/heading-conf.xml) 
    -o result=tmp.html -o report=report.xml -o files=files.xml  
    file:/$(cygpath -ma epubtools/modules/html-splitter/xpl/html-splitter.xpl) 
    base-uri=file:/$(cygpath -ma ../content/output/debug/epubtools/create-ops/pre-split.html)
    debug=yes
    debug-dir-uri=file:/$(cygpath -ma ../content/output/debug)</pre>
    <p xmlns:p="http://www.w3.org/ns/xproc" xmlns:epub="http://transpect.io/epubtools" xmlns:tr="http://transpect.io" xmlns:css="http://www.w3.org/1996/css" xmlns:html="http://www.w3.org/1999/xhtml" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:c="http://www.w3.org/ns/xproc-step" xmlns:j="http://marklogic.com/json" xmlns:cx="http://xmlcalabash.com/ns/extensions" xmlns:xlink="http://www.w3.org/1999/xlink">Calabash seems to suppress some XSLT errors, for instance when a stylesheet is looping. Therefore it might be
      necessary to replace collection()[…] with document(…) in the XSL (alternative variable declarations are already
      included in the xsl file, commented out) and run saxon from the command line, for example like this:</p>
    <pre xmlns:p="http://www.w3.org/ns/xproc" xmlns:epub="http://transpect.io/epubtools" xmlns:tr="http://transpect.io" xmlns:css="http://www.w3.org/1996/css" xmlns:html="http://www.w3.org/1999/xhtml" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:c="http://www.w3.org/ns/xproc-step" xmlns:j="http://marklogic.com/json" xmlns:cx="http://xmlcalabash.com/ns/extensions" xmlns:xlink="http://www.w3.org/1999/xlink">saxon -xsl:epubtools/modules/html-splitter/xsl/html-splitter.xsl -it:main \ 
      collection-uri=file:/path/to/debugdir/epubtools/html-splitter/…/splitter-input.catalog.xml) \ 
      -s:[any.xml] debug=yes debug-dir-uri=file:/other/path/to/debug/dir</pre>
  </p><h4>Import</h4><pre><code class="language-markup">&lt;p:import href="http://transpect.io/epubtools/modules/html-splitter/xpl/html-splitter.xpl"/&gt;</code></pre><h4>Dependencies</h4><ul><li><p><a href="modules-xproc-util.html">xproc-util</a></p></li></ul><h4>Synopsis</h4><pre><code class="language-markup">&lt;epub:html-splitter xmlns:epub="http://transpect.io/epubtools"&gt;
  &lt;p:input port="source" primary="true"/&gt;
  &lt;p:input port="conf" sequence="true" primary="false"/&gt;
  &lt;p:input port="meta" primary="false"/&gt;
  &lt;p:input port="css-xml"/&gt;
  &lt;p:output port="result" primary="true"/&gt;
  &lt;p:output port="files" primary="false"/&gt;
  &lt;p:output port="report"/&gt;
  &lt;p:output port="unused-css-resources" sequence="true"/&gt;
  &lt;p:output port="splitting-report" sequence="true"/&gt;
  &lt;p:option name="base-uri" required="true"/&gt;
  &lt;p:option name="target" select="'EPUB2'"/&gt;
  &lt;p:option name="debug" select="'no'"/&gt;
  &lt;p:option name="debug-dir-uri" select="'debug'"/&gt;
&lt;/epub:html-splitter&gt;</code></pre></div><div id="epub-insert-amzn-region-magnification" class="section scrollspy"><h2 class="header">epub:insert-amzn-region-magnification</h2><p> This pipeline adds Amazon's Region Magnification markup to each
    <code xmlns:p="http://www.w3.org/ns/xproc" xmlns:tr="http://transpect.io" xmlns:epub="http://transpect.io/epubtools" xmlns:c="http://www.w3.org/ns/xproc-step" xmlns:j="http://marklogic.com/json" xmlns:cx="http://xmlcalabash.com/ns/extensions" xmlns:xlink="http://www.w3.org/1999/xlink">div</code> which includes the <code xmlns:p="http://www.w3.org/ns/xproc" xmlns:tr="http://transpect.io" xmlns:epub="http://transpect.io/epubtools" xmlns:c="http://www.w3.org/ns/xproc-step" xmlns:j="http://marklogic.com/json" xmlns:cx="http://xmlcalabash.com/ns/extensions" xmlns:xlink="http://www.w3.org/1999/xlink">magnification</code> class:
    <pre xmlns:p="http://www.w3.org/ns/xproc" xmlns:tr="http://transpect.io" xmlns:epub="http://transpect.io/epubtools" xmlns:c="http://www.w3.org/ns/xproc-step" xmlns:j="http://marklogic.com/json" xmlns:cx="http://xmlcalabash.com/ns/extensions" xmlns:xlink="http://www.w3.org/1999/xlink"><code>&lt;div class="magnification"&gt;
  &lt;p id="p-1-02"&gt;A quick brown fox jumps over a lazy dog.&lt;/p&gt;
&lt;/div&gt;</code></pre>
    <p xmlns:p="http://www.w3.org/ns/xproc" xmlns:tr="http://transpect.io" xmlns:epub="http://transpect.io/epubtools" xmlns:c="http://www.w3.org/ns/xproc-step" xmlns:j="http://marklogic.com/json" xmlns:cx="http://xmlcalabash.com/ns/extensions" xmlns:xlink="http://www.w3.org/1999/xlink">The script adds Region Magnification markup according to <a href="https://kindlegen.s3.amazonaws.com/AmazonKindlePublishingGuidelines.pdf" target="_blank">Amazon's Kindle Publishing Guidelines</a>.
    </p>
    <pre xmlns:p="http://www.w3.org/ns/xproc" xmlns:tr="http://transpect.io" xmlns:epub="http://transpect.io/epubtools" xmlns:c="http://www.w3.org/ns/xproc-step" xmlns:j="http://marklogic.com/json" xmlns:cx="http://xmlcalabash.com/ns/extensions" xmlns:xlink="http://www.w3.org/1999/xlink"><code>&lt;div id="amzn-id-myBook-1-txt" class="source-mag"&gt;&lt;a class="app-amzn-magnify" data-app-amzn-magnify="{"targetId":"magTarget-amzn-id-myBook\
      _000019-1","sourceId":"magSource-amzn-id-myBook-1","ordinal":1}"&gt;
  &lt;p id="p-1-02"&gt;A quick brown fox jumps over a lazy dog.&lt;/p&gt;
&lt;/a&gt;&lt;/div&gt;&lt;div id="amzn-id-myBook-1-magTarget" class="target-mag"&gt;
  &lt;p&gt;A quick brown fox jumps over a lazy dog.&lt;/p&gt;
&lt;/div&gt;</code></pre>
    <p xmlns:p="http://www.w3.org/ns/xproc" xmlns:tr="http://transpect.io" xmlns:epub="http://transpect.io/epubtools" xmlns:c="http://www.w3.org/ns/xproc-step" xmlns:j="http://marklogic.com/json" xmlns:cx="http://xmlcalabash.com/ns/extensions" xmlns:xlink="http://www.w3.org/1999/xlink">Please note that you later need to execute a bash script which escapes the quotes. The script can be found here: <code>scripts/escape-for-amzn-region-magnification.sh</code></p>
  </p><h4>Import</h4><pre><code class="language-markup">&lt;p:import href="http://transpect.io/epubtools/modules/html-splitter/xpl/insert-amzn-region-magnification.xpl"/&gt;</code></pre><h4>Synopsis</h4><pre><code class="language-markup">&lt;epub:insert-amzn-region-magnification xmlns:epub="http://transpect.io/epubtools"&gt;
  &lt;p:input port="source" sequence="true"/&gt;
  &lt;p:output port="result" sequence="true"/&gt;
  &lt;p:option name="amzn-region-magnification" select="'false'"/&gt;
  &lt;p:option name="debug" select="'no'"/&gt;
  &lt;p:option name="debug-dir-uri" select="'debug'"/&gt;
&lt;/epub:insert-amzn-region-magnification&gt;</code></pre></div><div id="epub-split-css" class="section scrollspy"><h2 class="header">epub:split-css</h2><p>
    This pipeline is used to split the CSS based on the submitted value of the option <code xmlns:p="http://www.w3.org/ns/xproc" xmlns:tr="http://transpect.io" xmlns:css="http://www.w3.org/1996/css" xmlns:epub="http://transpect.io/epubtools" xmlns:c="http://www.w3.org/ns/xproc-step" xmlns:j="http://marklogic.com/json" xmlns:cx="http://xmlcalabash.com/ns/extensions" xmlns:xlink="http://www.w3.org/1999/xlink">css-handling</code>.
    With the value <code xmlns:p="http://www.w3.org/ns/xproc" xmlns:tr="http://transpect.io" xmlns:css="http://www.w3.org/1996/css" xmlns:epub="http://transpect.io/epubtools" xmlns:c="http://www.w3.org/ns/xproc-step" xmlns:j="http://marklogic.com/json" xmlns:cx="http://xmlcalabash.com/ns/extensions" xmlns:xlink="http://www.w3.org/1999/xlink">regenerated-per-split</code>, the CSS is analyzed and splitted for each HTML chunk. Commonly 
    used CSS properties are stored to a global CSS stylesheet, whereas unused CSS properties are filtered.
    With the value <code xmlns:p="http://www.w3.org/ns/xproc" xmlns:tr="http://transpect.io" xmlns:css="http://www.w3.org/1996/css" xmlns:epub="http://transpect.io/epubtools" xmlns:c="http://www.w3.org/ns/xproc-step" xmlns:j="http://marklogic.com/json" xmlns:cx="http://xmlcalabash.com/ns/extensions" xmlns:xlink="http://www.w3.org/1999/xlink">unchanged</code> CSS and HTML remain unchanged.
    Per default, a new CSS stylesheet is generated from the CSS XML representation.
  </p><h4>Import</h4><pre><code class="language-markup">&lt;p:import href="http://transpect.io/epubtools/modules/html-splitter/xpl/split-css.xpl"/&gt;</code></pre><h4>Dependencies</h4><ul><li><p><a href="modules-css-tools.html">css-tools</a></p></li><li><p><a href="modules-xproc-util.html">xproc-util</a></p></li></ul><h4>Synopsis</h4><pre><code class="language-markup">&lt;epub:split-css xmlns:epub="http://transpect.io/epubtools"&gt;
  &lt;p:input port="source" sequence="true" primary="true"/&gt;
  &lt;p:input port="css-xml" primary="false"/&gt;
  &lt;p:output port="result" sequence="true" primary="true"/&gt;
  &lt;p:output port="unused-css-resources" sequence="true" primary="false"/&gt;
  &lt;p:option name="target" required="true"/&gt;
  &lt;p:option name="css-handling" required="true"/&gt;
  &lt;p:option name="basename" required="true"/&gt;
  &lt;p:option name="html-subdir-name" required="true"/&gt;
  &lt;p:option name="common-source-dir-elimination-regex" required="true"/&gt;
  &lt;p:option name="debug" select="'no'"/&gt;
  &lt;p:option name="debug-dir-uri" select="'debug'"/&gt;
&lt;/epub:split-css&gt;</code></pre></div><div id="epub-zip-package" class="section scrollspy"><h2 class="header">epub:zip-package</h2><p> This step expects a file manifest as input and creates a zip-package. The file manifest should have
    been this form:
    
  </p><h4>Import</h4><pre><code class="language-markup">&lt;p:import href="http://transpect.io/epubtools/modules/zip-package/xpl/zip-package.xpl"/&gt;</code></pre><h4>Dependencies</h4><ul><li><p><a href="modules-xproc-util.html">xproc-util</a></p></li><li><p><a href="modules-xslt-util.html">xslt-util</a></p></li></ul><h4>Synopsis</h4><pre><code class="language-markup">&lt;epub:zip-package xmlns:epub="http://transpect.io/epubtools"&gt;
  &lt;p:input port="ocf-filerefs"/&gt;
  &lt;p:input port="opf-fileref"/&gt;
  &lt;p:input port="ops-filerefs"/&gt;
  &lt;p:input port="meta"/&gt;
  &lt;p:output port="result" primary="true"/&gt;
  &lt;p:output port="files" primary="false"/&gt;
  &lt;p:option name="base-uri" required="true"/&gt;
  &lt;p:option name="debug" select="'no'"/&gt;
  &lt;p:option name="debug-dir-uri" select="'debug'"/&gt;
&lt;/epub:zip-package&gt;</code></pre></div><div id="epub-convert" class="section scrollspy"><h2 class="header">epub:convert</h2><p> 
    <p xmlns:p="http://www.w3.org/ns/xproc" xmlns:cxf="http://xmlcalabash.com/ns/extensions/fileutils" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:epub="http://transpect.io/epubtools" xmlns:tr="http://transpect.io" xmlns:html="http://www.w3.org/1999/xhtml" xmlns:opf="http://www.idpf.org/2007/opf" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:ops="http://www.idpf.org/2007/ops" xmlns:c="http://www.w3.org/ns/xproc-step" xmlns:j="http://marklogic.com/json" xmlns:cx="http://xmlcalabash.com/ns/extensions" xmlns:xlink="http://www.w3.org/1999/xlink">This step takes a HTML file as input and converts it to an epub file. You need a configuration for the HTML splitting and
      the OPF metadata. Examples can be found in the sample directory. Invoke this step on the command line with:</p>
    <pre xmlns:p="http://www.w3.org/ns/xproc" xmlns:cxf="http://xmlcalabash.com/ns/extensions/fileutils" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:epub="http://transpect.io/epubtools" xmlns:tr="http://transpect.io" xmlns:html="http://www.w3.org/1999/xhtml" xmlns:opf="http://www.idpf.org/2007/opf" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:ops="http://www.idpf.org/2007/ops" xmlns:c="http://www.w3.org/ns/xproc-step" xmlns:j="http://marklogic.com/json" xmlns:cx="http://xmlcalabash.com/ns/extensions" xmlns:xlink="http://www.w3.org/1999/xlink"><code>calabash/calabash.sh -i source=sample/b978-3-646-92351-3.xhtml 
  -i conf=sample/hierarchy.xml -i meta=sample/epub-config.xml epub-convert.xpl </code></pre>
    <p xmlns:p="http://www.w3.org/ns/xproc" xmlns:cxf="http://xmlcalabash.com/ns/extensions/fileutils" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:epub="http://transpect.io/epubtools" xmlns:tr="http://transpect.io" xmlns:html="http://www.w3.org/1999/xhtml" xmlns:opf="http://www.idpf.org/2007/opf" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:ops="http://www.idpf.org/2007/ops" xmlns:c="http://www.w3.org/ns/xproc-step" xmlns:j="http://marklogic.com/json" xmlns:cx="http://xmlcalabash.com/ns/extensions" xmlns:xlink="http://www.w3.org/1999/xlink">Note that it’s advisable to make all file inputs absolute URIs, by using <code>cygpath</code> on Cygwin or <code>readlink -f</code>
    on Unixy systems. For bash, this is, e.g., <code>source=file:/$(cygpath -ma sample/b978-3-646-92351-3.xhtml)</code> </p>
  </p><h4>Import</h4><pre><code class="language-markup">&lt;p:import href="http://transpect.io/epubtools/xpl/epub-convert.xpl"/&gt;</code></pre><h4>Dependencies</h4><ul><li><p><a href="modules-schematron.html">schematron</a></p></li><li><p><a href="modules-xproc-util.html">xproc-util</a></p></li></ul><h4>Synopsis</h4><pre><code class="language-markup">&lt;epub:convert xmlns:epub="http://transpect.io/epubtools"&gt;
  &lt;p:input port="source" primary="true"/&gt;
  &lt;p:input port="conf" sequence="true" primary="false"/&gt;
  &lt;p:input port="meta" primary="false"/&gt;
  &lt;p:input port="schematron"/&gt;
  &lt;p:input port="attach-cover-xsl"/&gt;
  &lt;p:input port="custom-schematron" sequence="true"/&gt;
  &lt;p:input port="cover-svg"/&gt;
  &lt;p:input port="create-svg-cover-xsl" primary="false"/&gt;
  &lt;p:output port="result" primary="true"/&gt;
  &lt;p:output port="chunks" primary="false"/&gt;
  &lt;p:output port="opf" primary="false"/&gt;
  &lt;p:output port="files" primary="false"/&gt;
  &lt;p:output port="report" sequence="true" primary="false"/&gt;
  &lt;p:output port="html"/&gt;
  &lt;p:output port="baseuri" primary="false"/&gt;
  &lt;p:output port="input-for-schematron" primary="false"/&gt;
  &lt;p:option name="target" select="''"/&gt;
  &lt;p:option name="terminate-on-error" select="'yes'"/&gt;
  &lt;p:option name="clean-target-dir" select="'no'"/&gt;
  &lt;p:option name="debug" select="'no'"/&gt;
  &lt;p:option name="use-svg" required="false" select="''"/&gt;
  &lt;p:option name="debug-dir-uri" select="'debug'"/&gt;
  &lt;p:option name="status-dir-uri" select="'status'"/&gt;
  &lt;p:option name="id-in-report-heading" select="'false'"/&gt;
  &lt;p:option name="create-font-subset" required="false" select="'true'"/&gt;
  &lt;p:option name="create-svg-cover" required="false" select="'false'"/&gt;
  &lt;p:option name="convert-svg-cover" required="false" select="'false'"/&gt;
&lt;/epub:convert&gt;</code></pre></div><div id="d33927e263" class="status"><h2 class="header status"></h2><p class="last-updated">GitHub sync date: 2022-05-16+02:00</p></div></div>
          
          <div class="col hide-on-small-only m3 l2">
            <div class="toc-wrapper pin-top" style="top: 0px;">
              <div style="height: 1px;">
                <ul id="tr-toc" class="table-of-contents"><li><a href="#epub-create-ocf" class="active">epub:create-ocf</a></li><li><a href="#epub-create-opf">epub:create-opf</a></li><li><a href="#epub-create-ops">epub:create-ops</a></li><li><a href="#tr-create-font-subset">tr:create-font-subset</a></li><li><a href="#epub-html-splitter">epub:html-splitter</a></li><li><a href="#epub-insert-amzn-region-magnification">epub:insert-amzn-region-magnification</a></li><li><a href="#epub-split-css">epub:split-css</a></li><li><a href="#epub-zip-package">epub:zip-package</a></li><li><a href="#epub-convert">epub:convert</a></li><li><a href="#d33927e263"></a></li></ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
    <footer class="page-footer grey">
      <div class="container">
        <div class="row">
          <div id="tr-footer-1" class="col s12 m6 l4">
            <h5 class="white-text">GitHub</h5>
            <p class="white-text">Checkout the transpect repositories on GitHub and use transpect in your project. 
              Give us feedback, create issues and make pull requests.</p>
            <p><a target="_blank" href="https://github.com/transpect" class="btn red">GitHub</a></p>
          </div>
          <div id="tr-footer-2" class="col s12 m6 l4">
            <h5 class="white-text">Twitter</h5>
            <p class="white-text">News from le-tex’ XML machine room. Mostly related to 
              XSLT/XPath 2+, XProc, Relax NG, Schematron, and our 
              open-source framework transpect.
            </p>
            <p><a target="_blank" href="https://twitter.com/intent/user?screen_name=letexml" class="btn red">Follow @letexml</a></p>
          </div>
          <div id="tr-footer-3" class="col s12 m6 l4">
            <a target="_blank" href="http://www.le-tex.de"><object id="letex-logo" type="image/svg+xml" data="icons/logo-le-tex.svg">Your browser does not support SVG</object></a>
          </div>
        </div>
      </div>
      <div class="footer-copyright grey darken-1">
        <div class="container">
          <div class="row">
            <div id="tr-footer-copyright-1" class="col s12 m6 l6">
              <p class="white-text left">le-tex publishing services GmbH, 2021</p>
            </div>
            <div id="tr-footer-copyright-2" class="col s12 m6 l6">
              <p><a class="white-text right" href="http://www.le-tex.de">http://www.le-tex.de</a></p>
            </div>
          </div>
        </div>
      </div>
    </footer>
    
    <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
    <script type="text/javascript" src="js/prism.js"></script>
    <script type="text/javascript" src="js/materialize.min.js"></script>
    <script src="js/init.js"></script>
  </body>
</html>